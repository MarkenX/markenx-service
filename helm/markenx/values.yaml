replicaCount: 1
autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 3
  targetCPUUtilizationPercentage: 80

image:
  repository: markenx/markenx
  tag: "latest"
  pullPolicy: IfNotPresent

service:
  type: ClusterIP
  port: 8080

env:
  - name: SPRING_PROFILES_ACTIVE
    value: "dev"
  - name: SPRING_DATASOURCE_URL
    value: jdbc:mysql://{{ .Release.Name }}-mysql:3306/markenx_db?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC
  - name: SPRING_DATASOURCE_USERNAME
    value: markenx_user
  - name: SPRING_DATASOURCE_PASSWORD
    value: markenx_password_2025!
  - name: SPRING_JPA_HIBERNATE_DDL_AUTO
    value: create-drop
  - name: KEYCLOAK_AUTH_SERVER_URL
    value: http://{{ .Release.Name }}-keycloak:7080
  - name: KEYCLOAK_REALM
    value: markenx
  - name: KEYCLOAK_ADMIN_USERNAME
    value: admin
  - name: KEYCLOAK_ADMIN_PASSWORD
    value: admin123
  - name: SPRING_SECURITY_OAUTH2_RESOURCESERVER_JWT_ISSUER_URI
    value: http://{{ .Release.Name }}-keycloak:7080/realms/markenx
  - name: SPRING_SECURITY_OAUTH2_RESOURCESERVER_JWT_JWK_SET_URI
    value: http://{{ .Release.Name }}-keycloak:7080/realms/markenx/protocol/openid-connect/certs

resources:
  limits:
    cpu: 800m
    memory: 768Mi
  requests:
    cpu: 150m
    memory: 384Mi

 

livenessProbe:
  httpGet:
    path: /actuator/health/liveness
    port: 8080
  initialDelaySeconds: 120
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3

readinessProbe:
  httpGet:
    path: /actuator/health/readiness
    port: 8080
  initialDelaySeconds: 60
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 3

mysql:
  enabled: true
  auth:
    rootPassword: root_password_2025!
    database: markenx_db
    username: markenx_user
    password: markenx_password_2025!
  primary:
    persistence:
      enabled: false
    resources:
      limits:
        cpu: 400m
        memory: 768Mi
      requests:
        cpu: 50m
        memory: 192Mi

postgresql:
  enabled: true
  image:
    repository: postgres
    tag: "15-alpine"
    pullPolicy: IfNotPresent
  auth:
    database: keycloak_db
    username: keycloak_user
    password: keycloak_password_2025!
  service:
    type: ClusterIP
    port: 5432
  persistence:
    enabled: false
  resources:
    limits:
      cpu: 400m
      memory: 384Mi
    requests:
      cpu: 50m
      memory: 192Mi

keycloak:
  enabled: true
  image:
    repository: quay.io/keycloak/keycloak
    tag: 25.0.6
    pullPolicy: IfNotPresent
  replicas: 1
  maxSurge: 0
  maxUnavailable: 1
  service:
    type: ClusterIP
    port: 7080
  extraEnv:
    - name: KC_DB
      value: postgres
    - name: KC_DB_URL
      value: jdbc:postgresql://{{ .Release.Name }}-postgresql:5432/keycloak_db
    - name: KC_DB_USERNAME
      value: keycloak_user
    - name: KC_DB_PASSWORD
      value: keycloak_password_2025!
    - name: KEYCLOAK_ADMIN
      value: admin
    - name: KEYCLOAK_ADMIN_PASSWORD
      value: admin123
    - name: KC_HEALTH_ENABLED
      value: "true"
    - name: KC_HTTP_PORT
      value: "7080"
    - name: KC_TRANSACTION_XA_ENABLED
      value: "false"
  command:
    - start-dev
    - --http-port=7080
    - --import-realm
  livenessProbe:
    httpGet:
      path: /
      port: 7080
    initialDelaySeconds: 240
    periodSeconds: 20
    timeoutSeconds: 15
    failureThreshold: 15
  readinessProbe:
    httpGet:
      path: /
      port: 7080
    initialDelaySeconds: 180
    periodSeconds: 20
    timeoutSeconds: 15
    failureThreshold: 30
  resources:
    limits:
      cpu: 800m
      memory: 1Gi
    requests:
      cpu: 150m
      memory: 384Mi

serviceAccount:
  create: true
  name: ""
  annotations: {}
  automount: true

ingress:
  enabled: false
  className: ""
  annotations: {}
  hosts:
    - host: ""
      paths:
        - path: /
          pathType: Prefix
  tls: []

httpRoute:
  enabled: false
  parentRefs: []
  rules: []

podAnnotations: {}
podLabels: {}
nodeSelector: {}
affinity: {}
tolerations: []
